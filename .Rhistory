if((i==1)*(j==1)){
legend(ifelse(d.rea[length(d.nom)]>1,"bottomright","topright"),
c("Nominal bonds",
"ILBs",
"GDP-LBs"),
lty=c(2,1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2,2), # line width
col=c("dark grey","dark grey","black"), # gives the legend lines the correct color and width
bg="white",
seg.len = 2
)
}
}
}
dev.off()
# =====================================
# =====================================
# Tables
# =====================================
# =====================================
# Table with quantiles of debt-to-GDP
latex.table <- rbind(
"\\begin{table}",
"\\caption{Influence of issuance strategies on debt-to-GDP quantiles}",
"\\label{table_debt2GDP_quantiles}",
"\\begin{center}",
"\\begin{tabular*}{\\textwidth}{l@{\\extracolsep{\\fill}}lccccccccccc}",
#"\\hline",
"\\\\")
vec.of.quantiles <- c(.5,.9,.95)
first.line <- paste("Quantile &",
"\\multicolumn{3}{c}{Horizon: ",
toString(horizons.used.4.plots[1]/FREQ),ifelse(horizons.used.4.plots[1]<=4," year"," years"),"}",
"&",
"\\multicolumn{3}{c}{Horizon: ",
toString(horizons.used.4.plots[2]/FREQ),ifelse(horizons.used.4.plots[2]<=4," year"," years"),"}",
"\\\\",
sep="")
second.line <- "&Nominal&Infl.-linked&GDP-linked&Nominal&Infl.-linked&GDP-linked \\\\"
for(i in 1:length(vector.of.H)){
latex.table <- rbind(latex.table,
paste("&\\multicolumn{6}{c}{{\\bf Panel ",ifelse(i==1,"A","B")," -- Maturity of issued bonds: ",
toString(vector.of.H[i]/FREQ),
ifelse(vector.of.H[i]<=4," year"," years"),"}}\\\\",sep=""),
"\\\\",
"\\hline",
first.line,
"\\hline",
second.line,
"\\hline")
for(k in 1:length(vec.of.quantiles)){
this.line <- paste(toString(100*vec.of.quantiles[k]),"\\%",sep="")
for(j in 1:length(horizons.used.4.plots)){
for(type.of.bond in c(1,2,3)){
pdf <- density(all.sim.d[max.matur+horizons.used.4.plots[j],,type.of.bond,i])
#,bw = bw.4.kernel.density*sqrt(horizons.used.4.plots[j]))
this.line <- paste(this.line,"&",
round.fixed.length(quantile.density(pdf,vec.of.quantiles[k]),2)
,sep="")
}
}
this.line <- paste(this.line,"\\\\")
latex.table <- rbind(latex.table,
this.line)
}
if(i != length(vector.of.H)){
latex.table <- rbind(latex.table,
"\\hline",
"\\\\")
}else{
latex.table <- rbind(latex.table,
"\\hline")
}
}
latex.table <- rbind(latex.table,
"\\end{tabular*}",
"\\end{center}",
"\\begin{scriptsize}",
"\\parbox{\\linewidth}{",
"Note: This table reports the quantiles of the distributions of debt-to-GDP ratios resulting
from different issuance strategies. The issuance strategies are basic strategies whereby the government,
on each period, issues the same type of bonds to meet its funding needs.",
"}",
"\\end{scriptsize}",
"\\end{table}")
latex.file <- paste(output.tables.folder,"/table_debt_quantiles.txt",sep="")
write(latex.table, file = latex.file)
output.tables.folder
FILE <- paste("estimation/results/",result.file,".Rdat",sep="")
load(FILE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/make.tables.R", echo=TRUE)
Model.est <- Theta.2.Model(Full.Theta)
load("save_tempo.Rdat")
result.file
save(Full.Theta,file=paste("estimation/results/",result.file,".Rdat",sep=""))
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/make.tables.R", echo=TRUE)
coef.mult <- 3
Model.est$g
Model.est$g_c
Model.est$g_d
Model.est$sigma.eps
names(Model.est)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/make.tables.R", echo=TRUE)
names(Model.est)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/make.tables.R", echo=TRUE)
source('prepare_outputs/make.tables.R')
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.curves.R", echo=TRUE)
indic.plot.nominal <- 1
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.curves.R", echo=TRUE)
dev.off()
dev.off()
dev.off()
dev.off()
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.curves.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.curves.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.sensitivity.R", echo=TRUE)
res.prices$values.S
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.sensitivity.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.sensitivity.R", echo=TRUE)
matur.shown.curves
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.sensitivity.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.sensitivity.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.sensitivity.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.sensitivity.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.sensitivity.R", echo=TRUE)
res.prices$values.S
adj
NB.values.s
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.sensitivity.R", echo=TRUE)
adj
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.sensitivity.R", echo=TRUE)
plot(res.prices$values.S[index.min.S.4.price_sensitivity:index.max.S.4.price_sensitivity],
res.prices$all.GDP.bond.yields[matur.shown.curves[1],index.min.S.4.price_sensitivity:index.max.S.4.price_sensitivity],
type="l",lwd=2,las=1,col="white",
ylim = ylim,
main=paste("Regime ",j,sep=""),
xlab=expression(paste("Consumption surplus (",S[t],")",sep="")),
ylab="Annualized yield to maturity")
dev.off()
dev.off()
dev.off()
plot(res.prices$values.S[index.min.S.4.price_sensitivity:index.max.S.4.price_sensitivity],
res.prices$all.GDP.bond.yields[matur.shown.curves[1],index.min.S.4.price_sensitivity:index.max.S.4.price_sensitivity],
type="l",lwd=2,las=1,col="white",
ylim = ylim,
main=paste("Regime ",j,sep=""),
xlab=expression(paste("Consumption surplus (",S[t],")",sep="")),
ylab="Annualized yield to maturity")
adj <- (res.prices$values.S[(index.min.S.4.price_sensitivity+1):index.max.S.4.price_sensitivity] - res.prices$values.S[(index.min.S.4.price_sensitivity):(index.max.S.4.price_sensitivity-1)])
#/(res.prices$values.s[(index.min.S.4.price_sensitivity+1):NB.values.s] - res.prices$values.s[(index.min.S.4.price_sensitivity):(NB.values.s-1)])
adj <- 1/adj
Ez <- Ez + res.mom.pi.z$E.z[(NB.values.s*(j-1)+index.min.S.4.price_sensitivity+1):
(NB.values.s*(j-1)+index.max.S.4.price_sensitivity)]
polygon(c(res.prices$values.S[(index.min.S.4.price_sensitivity+1):index.max.S.4.price_sensitivity],res.prices$values.S[index.max.S.4.price_sensitivity:(index.min.S.4.price_sensitivity+1)]),
.002*c(adj*Ez,0*res.mom.pi.z$E.z[(index.min.S.4.price_sensitivity+1):index.max.S.4.price_sensitivity]),
col=rgb(0,0,0,alpha=0.2),border=NA)
lines(
res.prices$values.S[index.min.S.4.price_sensitivity:index.max.S.4.price_sensitivity],
res.prices$all.GDP.bond.yields[matur.shown.curves[1],(NB.values.s*(j-1)+index.min.S.4.price_sensitivity+1):
(NB.values.s*(j-1)+index.max.S.4.price_sensitivity)],
lty=2,lwd=2)
res.prices$values.S[index.min.S.4.price_sensitivity:index.max.S.4.price_sensitivity]
res.prices$all.GDP.bond.yields[matur.shown.curves[1],(NB.values.s*(j-1)+index.min.S.4.price_sensitivity+1):
(NB.values.s*(j-1)+index.max.S.4.price_sensitivity)]
Ez <- Ez + res.mom.pi.z$E.z[(NB.values.s*(j-1)+index.min.S.4.price_sensitivity):
(NB.values.s*(j-1)+index.max.S.4.price_sensitivity)]
polygon(c(res.prices$values.S[(index.min.S.4.price_sensitivity+1):index.max.S.4.price_sensitivity],res.prices$values.S[index.max.S.4.price_sensitivity:(index.min.S.4.price_sensitivity+1)]),
.002*c(adj*Ez,0*res.mom.pi.z$E.z[(index.min.S.4.price_sensitivity+1):index.max.S.4.price_sensitivity]),
col=rgb(0,0,0,alpha=0.2),border=NA)
adj <- (res.prices$values.S[(index.min.S.4.price_sensitivity+1):index.max.S.4.price_sensitivity] - res.prices$values.S[(index.min.S.4.price_sensitivity):(index.max.S.4.price_sensitivity-1)])
#/(res.prices$values.s[(index.min.S.4.price_sensitivity+1):NB.values.s] - res.prices$values.s[(index.min.S.4.price_sensitivity):(NB.values.s-1)])
adj <- 1/adj
Ez <- Ez + res.mom.pi.z$E.z[(NB.values.s*(j-1)+index.min.S.4.price_sensitivity+1):
(NB.values.s*(j-1)+index.max.S.4.price_sensitivity)]
polygon(c(res.prices$values.S[(index.min.S.4.price_sensitivity+1):index.max.S.4.price_sensitivity],res.prices$values.S[index.max.S.4.price_sensitivity:(index.min.S.4.price_sensitivity+1)]),
.002*c(adj*Ez,0*res.mom.pi.z$E.z[(index.min.S.4.price_sensitivity+1):index.max.S.4.price_sensitivity]),
col=rgb(0,0,0,alpha=0.2),border=NA)
plot(res.prices$values.S[index.min.S.4.price_sensitivity:index.max.S.4.price_sensitivity],
res.prices$all.GDP.bond.yields[matur.shown.curves[1],index.min.S.4.price_sensitivity:index.max.S.4.price_sensitivity],
type="l",lwd=2,las=1,col="white",
ylim = ylim,
main=paste("Regime ",j,sep=""),
xlab=expression(paste("Consumption surplus (",S[t],")",sep="")),
ylab="Annualized yield to maturity")
adj <- (res.prices$values.S[(index.min.S.4.price_sensitivity+1):index.max.S.4.price_sensitivity] - res.prices$values.S[(index.min.S.4.price_sensitivity):(index.max.S.4.price_sensitivity-1)])
#/(res.prices$values.s[(index.min.S.4.price_sensitivity+1):NB.values.s] - res.prices$values.s[(index.min.S.4.price_sensitivity):(NB.values.s-1)])
adj <- 1/adj
Ez <- Ez + res.mom.pi.z$E.z[(NB.values.s*(j-1)+index.min.S.4.price_sensitivity):
(NB.values.s*(j-1)+index.max.S.4.price_sensitivity)]
polygon(c(res.prices$values.S[(index.min.S.4.price_sensitivity+1):index.max.S.4.price_sensitivity],res.prices$values.S[index.max.S.4.price_sensitivity:(index.min.S.4.price_sensitivity+1)]),
.002*c(adj*Ez,0*res.mom.pi.z$E.z[(index.min.S.4.price_sensitivity+1):index.max.S.4.price_sensitivity]),
col=rgb(0,0,0,alpha=0.2),border=NA)
plot(res.prices$values.S[index.min.S.4.price_sensitivity:index.max.S.4.price_sensitivity],
res.prices$all.GDP.bond.yields[matur.shown.curves[1],index.min.S.4.price_sensitivity:index.max.S.4.price_sensitivity],
type="l",lwd=2,las=1,col="white",
ylim = ylim,
main=paste("Regime ",j,sep=""),
xlab=expression(paste("Consumption surplus (",S[t],")",sep="")),
ylab="Annualized yield to maturity")
adj <- (res.prices$values.S[(index.min.S.4.price_sensitivity+1):index.max.S.4.price_sensitivity] - res.prices$values.S[(index.min.S.4.price_sensitivity):(index.max.S.4.price_sensitivity-1)])
#/(res.prices$values.s[(index.min.S.4.price_sensitivity+1):NB.values.s] - res.prices$values.s[(index.min.S.4.price_sensitivity):(NB.values.s-1)])
adj <- 1/adj
adj
Ez <- Ez + res.mom.pi.z$E.z[(NB.values.s*(j-1)+index.min.S.4.price_sensitivity+1):
(NB.values.s*(j-1)+index.max.S.4.price_sensitivity)]
Ez <- Ez + res.mom.pi.z$E.z[(NB.values.s*(j-1)+index.min.S.4.price_sensitivity+1):
(NB.values.s*(j-1)+index.max.S.4.price_sensitivity)]
Ez <- res.mom.pi.z$E.z[(NB.values.s*(j-1)+index.min.S.4.price_sensitivity+1):
(NB.values.s*(j-1)+index.max.S.4.price_sensitivity)]
Ez
polygon(c(res.prices$values.S[(index.min.S.4.price_sensitivity+1):index.max.S.4.price_sensitivity],res.prices$values.S[index.max.S.4.price_sensitivity:(index.min.S.4.price_sensitivity+1)]),
.002*c(adj*Ez,0*res.mom.pi.z$E.z[(index.min.S.4.price_sensitivity+1):index.max.S.4.price_sensitivity]),
col=rgb(0,0,0,alpha=0.2),border=NA)
lines(
res.prices$values.S[index.min.S.4.price_sensitivity:index.max.S.4.price_sensitivity],
res.prices$all.GDP.bond.yields[matur.shown.curves[1],(NB.values.s*(j-1)+index.min.S.4.price_sensitivity+1):
(NB.values.s*(j-1)+index.max.S.4.price_sensitivity)],
lty=2,lwd=2)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.sensitivity.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.sensitivity.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.sensitivity.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.sensitivity.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.sensitivity.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.sensitivity.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.sensitivity.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.distri.IR.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.distri.IR.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.distri.IR.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.distri.IR.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.distri.IR.R", echo=TRUE)
x.axis
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.distri.IR.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.distri.IR.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.distri.IR.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.distri.IR.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.distri.IR.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.distri.IR.R", echo=TRUE)
maturity
vector.of.maturities.4
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.distri.IR.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.distri.IR.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.distri.IR.R", echo=TRUE)
# Table with model parameters:
source('prepare_outputs/make.tables.R')
#setwd("prepare_outputs/LatexPlots")
# Chart showing average yield curves:
indic.plot.nominal <- 1
source('prepare_outputs/chart.curves.R')
# Chart showing sensitivity of yields to consumption surplus:
source('prepare_outputs/chart.sensitivity.R')
# Chart showing interest rate distributions:
source('prepare_outputs/chart.distri.IR.R')
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.historical.fit.R", echo=TRUE)
file   <- "Figure_termpremiums"
pdf(file=paste(output.figures.folder,"/",file,".pdf",sep=""),
pointsize=8, width=6, height=4)
fitted.2yr.underP <- res.prices.underP$all.nom.bond.F.yields[2,z.hat] +
res.prices.underP$all.nom.bond.b.yields[2] * pi.hat
fitted.2yr.underQ <- res.prices$all.nom.bond.F.yields[2,z.hat] +
res.prices$all.nom.bond.b.yields[2] * pi.hat
fitted.10yr.underP <- res.prices.underP$all.nom.bond.F.yields[3,z.hat] +
res.prices.underP$all.nom.bond.b.yields[3] * pi.hat
fitted.10yr.underQ <- res.prices$all.nom.bond.F.yields[3,z.hat] +
res.prices$all.nom.bond.b.yields[3] * pi.hat
par(mfrow=c(1,2))
par(plt=c(.15,.95,.1,.85))
plot(vec.dates,fitted.2yr.underQ,type="l",lwd=2,ylim=c(0,.09),
main="(a) 2-year maturity",xlab="",ylab="",las=1)
lines(vec.dates,fitted.2yr.underP,col="dark grey",lwd=2,las=1)
lines(vec.dates,fitted.2yr.underQ-fitted.2yr.underP,col="blue",lwd=3,lty=3)
grid()
legend("topright", # places a legend at the appropriate place c("Health","Defense"), # puts text in the legend
c("yield","yield under EH","Term premium"),
lty=c(1,1,3), # gives the legend appropriate symbols (lines)
lwd=c(2,2,3), # line width
col=c("black","dark grey","blue"),
bg="white",
#pch=c(NaN,22),
#pt.bg=c(NaN,rgb(0,0,0,alpha=0.2)),
#pt.cex = c(2),
seg.len = 2
)
plot(vec.dates,fitted.10yr.underQ,type="l",ylim=c(0,.09),
main="(b) 10-year maturity",xlab="",ylab="",lwd=2,las=1)
lines(vec.dates,fitted.10yr.underP,col="dark grey",lwd=2)
lines(vec.dates,fitted.10yr.underQ-fitted.10yr.underP,col="blue",lwd=3,lty=3)
grid()
dev.off()
file   <- "Figure_termpremiums"
pdf(file=paste(output.figures.folder,"/",file,".pdf",sep=""),
pointsize=8, width=8, height=4)
fitted.2yr.underP <- res.prices.underP$all.nom.bond.F.yields[2,z.hat] +
res.prices.underP$all.nom.bond.b.yields[2] * pi.hat
fitted.2yr.underQ <- res.prices$all.nom.bond.F.yields[2,z.hat] +
res.prices$all.nom.bond.b.yields[2] * pi.hat
fitted.10yr.underP <- res.prices.underP$all.nom.bond.F.yields[3,z.hat] +
res.prices.underP$all.nom.bond.b.yields[3] * pi.hat
fitted.10yr.underQ <- res.prices$all.nom.bond.F.yields[3,z.hat] +
res.prices$all.nom.bond.b.yields[3] * pi.hat
par(mfrow=c(1,2))
par(plt=c(.15,.95,.1,.85))
plot(vec.dates,fitted.2yr.underQ,type="l",lwd=2,ylim=c(0,.09),
main="(a) 2-year maturity",xlab="",ylab="",las=1)
lines(vec.dates,fitted.2yr.underP,col="dark grey",lwd=2,las=1)
lines(vec.dates,fitted.2yr.underQ-fitted.2yr.underP,col="blue",lwd=3,lty=3)
grid()
legend("topright", # places a legend at the appropriate place c("Health","Defense"), # puts text in the legend
c("yield","yield under EH","Term premium"),
lty=c(1,1,3), # gives the legend appropriate symbols (lines)
lwd=c(2,2,3), # line width
col=c("black","dark grey","blue"),
bg="white",
#pch=c(NaN,22),
#pt.bg=c(NaN,rgb(0,0,0,alpha=0.2)),
#pt.cex = c(2),
seg.len = 2
)
plot(vec.dates,fitted.10yr.underQ,type="l",ylim=c(0,.09),
main="(b) 10-year maturity",xlab="",ylab="",lwd=2,las=1)
lines(vec.dates,fitted.10yr.underP,col="dark grey",lwd=2)
lines(vec.dates,fitted.10yr.underQ-fitted.10yr.underP,col="blue",lwd=3,lty=3)
grid()
dev.off()
file   <- "Figure_termpremiums"
pdf(file=paste(output.figures.folder,"/",file,".pdf",sep=""),
pointsize=8, width=9, height=4)
fitted.2yr.underP <- res.prices.underP$all.nom.bond.F.yields[2,z.hat] +
res.prices.underP$all.nom.bond.b.yields[2] * pi.hat
fitted.2yr.underQ <- res.prices$all.nom.bond.F.yields[2,z.hat] +
res.prices$all.nom.bond.b.yields[2] * pi.hat
fitted.10yr.underP <- res.prices.underP$all.nom.bond.F.yields[3,z.hat] +
res.prices.underP$all.nom.bond.b.yields[3] * pi.hat
fitted.10yr.underQ <- res.prices$all.nom.bond.F.yields[3,z.hat] +
res.prices$all.nom.bond.b.yields[3] * pi.hat
par(mfrow=c(1,2))
par(plt=c(.15,.95,.1,.85))
plot(vec.dates,fitted.2yr.underQ,type="l",lwd=2,ylim=c(0,.09),
main="(a) 2-year maturity",xlab="",ylab="",las=1)
lines(vec.dates,fitted.2yr.underP,col="dark grey",lwd=2,las=1)
lines(vec.dates,fitted.2yr.underQ-fitted.2yr.underP,col="blue",lwd=3,lty=3)
grid()
legend("topright", # places a legend at the appropriate place c("Health","Defense"), # puts text in the legend
c("yield","yield under EH","Term premium"),
lty=c(1,1,3), # gives the legend appropriate symbols (lines)
lwd=c(2,2,3), # line width
col=c("black","dark grey","blue"),
bg="white",
#pch=c(NaN,22),
#pt.bg=c(NaN,rgb(0,0,0,alpha=0.2)),
#pt.cex = c(2),
seg.len = 2
)
plot(vec.dates,fitted.10yr.underQ,type="l",ylim=c(0,.09),
main="(b) 10-year maturity",xlab="",ylab="",lwd=2,las=1)
lines(vec.dates,fitted.10yr.underP,col="dark grey",lwd=2)
lines(vec.dates,fitted.10yr.underQ-fitted.10yr.underP,col="blue",lwd=3,lty=3)
grid()
dev.off()
file   <- "Figure_historical_fit_macro"
pdf(file=paste(output.figures.folder,"/",file,".pdf",sep=""),
pointsize=10, width=8, height=7)
par(mfrow=c(3,2))
par(plt=c(.1,.95,.2,.85))
# Plot fitted inflation:
plot(vec.dates,pi.hat,type="l",lwd=2,
main="(a) Inflation",xlab="",ylab="")
points(vec.dates,pi.US,col="dark grey",pch=3,lwd=2)
legend("topright", # places a legend at the appropriate place c("Health","Defense"), # puts text in the legend
c("Data","Model"),
lty=c(NaN,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2), # line width
col=c("dark grey","black"),
bg="white",
pch=c(3,NaN),
#pt.bg=c(NaN,rgb(0,0,0,alpha=0.2)),
#pt.cex = c(2),
seg.len = 2
)
# Recover delta(c_t):
z.hat_1 <- c(NaN,z.hat[1:(length(z.hat)-1)])
nu.hat <- 1/res.prices$Model.solved$lambda[z.hat_1] * (res.prices$Model.solved$mu[z.hat] -
(1-Model$phi)*res.prices$s.bar
- Model$phi * res.prices$Model.solved$mu[z.hat_1]
)
resulting.dc <- res.prices$Model.solved$g[z.hat_1] + nu.hat
plot(vec.dates,resulting.dc,type="l",lwd=2,
main="(b) Consumption growth",xlab="",ylab="")
points(vec.dates,dc.US,col="dark grey",pch=3,lwd=2)
# # Stock returns
# # Compute quarterly stock return:
# T <- length(z.hat)
# Mt_1t <- apply(matrix(1:T,T,1),1,
#                function(i){res.prices$M[z.hat_1[i],z.hat[i]]})
# Rt_4t <- Mt_1t * c(NaN,Mt_1t[1:(T-1)]) *
#   c(NaN,NaN,Mt_1t[1:(T-2)]) * c(NaN,NaN,NaN,Mt_1t[1:(T-3)]) - 1
# plot(vec.dates,Rt_4t,col="red",type="l")
# # lines(Data_Shiller$Date[indic.first.date.in.Shiller.database:indic.last.date.in.Shiller.database],
# #       stock.returns,type="l")
# points(Data_ShillerQ$Date,Data_ShillerQ$stock.returns.real)
# Infl forecasts 4Q:
resulting.infl4Q <- res.estim$fitted[,6]
plot(vec.dates,resulting.infl4Q,type="l",
ylim=c(min(resulting.infl4Q,infl.forecast.4Q,na.rm = TRUE),
max(resulting.infl4Q,infl.forecast.4Q,na.rm = TRUE)),lwd=2,
main="(c) 1-year inflation forecasts",xlab="",ylab="")
points(vec.dates,infl.forecast.4Q,col="dark grey",pch=3,lwd=2)
# GDP forecasts 4Q:
resulting.GDP4Q <- res.estim$fitted[,5]
plot(vec.dates,resulting.GDP4Q,type="l",
ylim=c(min(resulting.GDP4Q,gdp.forecast.4Q,na.rm = TRUE),
max(resulting.GDP4Q,gdp.forecast.4Q,na.rm = TRUE)),lwd=2,
main="(d) 1-year GDP growth forecasts",xlab="",ylab="")
points(vec.dates,gdp.forecast.4Q,col="dark grey",pch=3,lwd=2)
# Infl forecasts 8Q:
resulting.infl8Q <- res.estim$fitted[,8]
plot(vec.dates,resulting.infl8Q,type="l",
ylim=c(min(resulting.infl8Q,infl.forecast.8Q,na.rm = TRUE),
max(resulting.infl8Q,infl.forecast.8Q,na.rm = TRUE)),lwd=2,
main="(e) 2-year inflation forecasts",xlab="",ylab="")
points(vec.dates,infl.forecast.8Q,col="dark grey",pch=3,lwd=2)
# GDP forecasts 8Q:
resulting.GDP8Q <- res.estim$fitted[,7]
plot(vec.dates,resulting.GDP8Q,type="l",
ylim=c(min(resulting.GDP8Q,gdp.forecast.8Q,na.rm = TRUE),
max(resulting.GDP8Q,gdp.forecast.8Q,na.rm = TRUE)),lwd=2,
main="(f) 2-year GDP growth forecasts",xlab="",ylab="")
points(vec.dates,gdp.forecast.8Q,col="dark grey",pch=3,lwd=2)
dev.off()
file   <- "Figure_historical_fit_yds"
pdf(file=paste(output.figures.folder,"/",file,".pdf",sep=""),
pointsize=10, width=7, height=5)
par(mfrow=c(2,2))
par(plt=c(.1,.95,.2,.85))
maturities.in.yrs.yields <- c(2,10)
indic.of.yds.in.res.prices <- c(
which(res.prices$vec.maturities == Model$freq*maturities.in.yrs.yields[1]),
which(res.prices$vec.maturities == Model$freq*maturities.in.yrs.yields[2])
)
# Check resulting 2-year real rates:
resulting.2Y.TIPS <- res.prices$all.rea.bond.yields[indic.of.yds.in.res.prices[1],z.hat]
plot(vec.dates,resulting.2Y.TIPS,type="l",lwd=2,
main="(a) 2-year real yield",xlab="",ylab="")
points(vec.dates,US_yields_q$TIPSY02/100,col="dark grey",pch=3,lwd=2)
legend("topright", # places a legend at the appropriate place c("Health","Defense"), # puts text in the legend
c("Data","Model"),
lty=c(NaN,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2), # line width
col=c("dark grey","black"),
bg="white",
pch=c(3,NaN),
#pt.bg=c(NaN,rgb(0,0,0,alpha=0.2)),
#pt.cex = c(2),
seg.len = 2
)
# Check resulting 10-year real rates:
resulting.10Y.TIPS <- res.prices$all.rea.bond.yields[indic.of.yds.in.res.prices[2],z.hat]
plot(vec.dates,resulting.10Y.TIPS,type="l",lwd=2,
main="(b) 10-year real yield",xlab="",ylab="")
points(vec.dates,US_yields_q$TIPSY10/100,col="dark grey",pch=3,lwd=2)
# Check resulting 2-year nominal rates:
# resulting.2Y.nom <- res.prices$all.nom.bond.F.yields[8,z.hat] +
#   res.prices$all.nom.bond.b.yields[8] * pi.hat
resulting.2Y.nom <- res.estim$fitted[,1]
plot(vec.dates,resulting.2Y.nom,type="l",lwd=2,
main="(c) 2-year nominal yield",xlab="",ylab="")
points(vec.dates,US_yields_q$SVENY02/100,col="dark grey",pch=3,lwd=2)
# Check resulting 10-year nominal rates:
observed.10Y.nom  <- res.estim$observed[,2]
resulting.10Y.nom <- res.estim$fitted[,2]
plot(vec.dates,resulting.10Y.nom,type="l",lwd=2,
main="(d) 10-year nominal yield",xlab="",ylab="")
points(vec.dates,US_yields_q$SVENY10/100,col="dark grey",pch=3,lwd=2)
dev.off()
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/prepare_outputs/chart.historical.fit.R", echo=TRUE)
set.seed(124)
NB.values.s <- 100 # number of discretized values of s
fixed.bs <- -0.01 # fixed budget primary surplus
ini.debt.to.GDP <- 4.00 # expressed in GDP percent (nominal GDP of one model period)
vector.of.H           <- c(4,40) # Maturites of issued bonds -- expressed at the model frequency
horizons.used.4.plots <- c(8,80) # Horizons considered, expressed in number of model periods
N.sim <- 10000 # number of simulations
N.sim <- 200 # number of simulations
source('simulations/run.debt.dyn_PDFs.R')
nb.periods
set.seed(124)
vector.of.H       <- c(4,20,40) # maturities of considered bonds -- expressed at the model frequency
vector.of.weights <- 0:1 # relative importances of Nom/ILB/GDP-LB
nb.periods <- 40000 # number of simulated periods
ini.debt.to.GDP <- 400 # expressed in GDP percent. Caution: GDP is nominal GDP for one model period
nb.periods
nb.periods <- 1000
ini.debt.to.GDP <- 400 # expressed in GDP percent. Caution: GDP is nominal GDP for one model period
source('simulations/run.debt.dyn_XYplots.R')
max.matur
max.horizon
dim(res.simul$GDP.fcsts)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/simulations/run.debt.dyn_XYplots.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/simulations/run.debt.dyn_XYplots.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/simulations/run.debt.dyn_XYplots.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/main.R", echo=TRUE)
result.file
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/main.R", echo=TRUE)
indic.include.nominal
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/main.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/main.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/main.R", echo=TRUE)
first.year
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/divers/diversification.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/main.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/main.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/main.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/A_Main/main.R", echo=TRUE)
