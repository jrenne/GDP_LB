USY_Yds_TermPremium$DATE <- as.Date(USY_Yds_TermPremium$DATE)
first.year <- as.numeric(format(USY_Yds_TermPremium$DATE[1],"%Y"))
last.year  <- as.numeric(format(last.date,"%Y"))
USY_Yds_TermPremium$year  <- as.numeric(format(USY_Yds_TermPremium$DATE,"%Y"))
USY_Yds_TermPremium$month <- as.numeric(format(USY_Yds_TermPremium$DATE,"%m"))
USY_Yds_TermPremium_Q <- data.frame(USY_Yds_TermPremium[1,])
count <- 0
for(Year in first.year:last.year){
for(Q in 1:4){
count <- count + 1
data.tempo <- subset(USY_Yds_TermPremium,(year==Year)&(month %in% c(3*(Q-1) + 1:3)))
USY_Yds_TermPremium_Q[count,2:dim(USY_Yds_TermPremium_Q)[2]] <-
apply(data.tempo[,2:dim(USY_Yds_TermPremium_Q)[2]],2,function(x){mean(x,na.rm=TRUE)})
data.tempo$Date[count,1] <- as.Date(paste(Year,"-",3*(Q-1)+1,"-01",sep=""))
}
}
as.Date(paste(Year,"-",3*(Q-1)+1,"-01",sep=""))
data.tempo$Date[count,1]
USY_Yds_TermPremium <- read.csv("data/USY_Yds_TermPremium.csv")
USY_Yds_TermPremium$DATE <- as.Date(USY_Yds_TermPremium$DATE)
first.year <- as.numeric(format(USY_Yds_TermPremium$DATE[1],"%Y"))
last.year  <- as.numeric(format(last.date,"%Y"))
USY_Yds_TermPremium$year  <- as.numeric(format(USY_Yds_TermPremium$DATE,"%Y"))
USY_Yds_TermPremium$month <- as.numeric(format(USY_Yds_TermPremium$DATE,"%m"))
USY_Yds_TermPremium_Q <- data.frame(USY_Yds_TermPremium[1,])
count <- 0
for(Year in first.year:last.year){
for(Q in 1:4){
count <- count + 1
data.tempo <- subset(USY_Yds_TermPremium,(year==Year)&(month %in% c(3*(Q-1) + 1:3)))
USY_Yds_TermPremium_Q[count,2:dim(USY_Yds_TermPremium_Q)[2]] <-
apply(data.tempo[,2:dim(USY_Yds_TermPremium_Q)[2]],2,function(x){mean(x,na.rm=TRUE)})
data.tempo$DATE[count] <- as.Date(paste(Year,"-",3*(Q-1)+1,"-01",sep=""))
}
}
USY_Yds_TermPremium_Q$DATE[count] <- as.Date(paste(Year,"-",3*(Q-1)+1,"-01",sep=""))
USY_Yds_TermPremium <- read.csv("data/USY_Yds_TermPremium.csv")
USY_Yds_TermPremium$DATE <- as.Date(USY_Yds_TermPremium$DATE)
first.year <- as.numeric(format(USY_Yds_TermPremium$DATE[1],"%Y"))
last.year  <- as.numeric(format(last.date,"%Y"))
USY_Yds_TermPremium$year  <- as.numeric(format(USY_Yds_TermPremium$DATE,"%Y"))
USY_Yds_TermPremium$month <- as.numeric(format(USY_Yds_TermPremium$DATE,"%m"))
USY_Yds_TermPremium_Q <- data.frame(USY_Yds_TermPremium[1,])
count <- 0
for(Year in first.year:last.year){
for(Q in 1:4){
count <- count + 1
data.tempo <- subset(USY_Yds_TermPremium,(year==Year)&(month %in% c(3*(Q-1) + 1:3)))
USY_Yds_TermPremium_Q[count,2:dim(USY_Yds_TermPremium_Q)[2]] <-
apply(data.tempo[,2:dim(USY_Yds_TermPremium_Q)[2]],2,function(x){mean(x,na.rm=TRUE)})
USY_Yds_TermPremium_Q$DATE[count] <- as.Date(paste(Year,"-",3*(Q-1)+1,"-01",sep=""))
}
}
plot(USY_Yds_TermPremium_Q$DATE,USY_Yds_TermPremium_Q$THREEFYTP10,type="l")
plot(vec.dates,fitted.10yr.underQ-fitted.10yr.underP,type="l",col="red")
plot(USY_Yds_TermPremium_Q$DATE,USY_Yds_TermPremium_Q$THREEFYTP10,type="l")
par(new=TRUE)
plot(vec.dates,fitted.10yr.underQ-fitted.10yr.underP,type="l",col="red")
vec.dates
USY_Yds_TermPremium_Q$DATE
plot(vec.dates,fitted.2yr.underQ-fitted.2yr.underP,type="l",lwd=3,lty=3,
ylim=c(-.01,.025),col="blue",
main="(c) 2-year term premium",xlab="",ylab="",las=1)
lines(USY_Yds_TermPremium_Q$DATE,USY_Yds_TermPremium_Q$THREEFYTP2,
col="dark grey",lwd=2,lty=3)
plot(vec.dates,fitted.2yr.underQ-fitted.2yr.underP,type="l",lwd=3,lty=3,
ylim=c(-.01,.025),col="blue",
main="(c) 2-year term premium",xlab="",ylab="",las=1)
lines(USY_Yds_TermPremium_Q$DATE,USY_Yds_TermPremium_Q$THREEFYTP2/100,
col="dark grey",lwd=2,lty=3)
plot(vec.dates,fitted.2yr.underQ-fitted.2yr.underP,type="l",lwd=3,lty=3,
ylim=c(-.005,.015),col="blue",
main="(c) 2-year term premium",xlab="",ylab="",las=1)
lines(USY_Yds_TermPremium_Q$DATE,USY_Yds_TermPremium_Q$THREEFYTP2/100,
col="dark grey",lwd=2,lty=3)
plot(vec.dates,fitted.2yr.underQ-fitted.2yr.underP,type="l",lwd=3,lty=3,
ylim=c(-.005,.015),col="blue",
main="(c) 2-year term premium",xlab="",ylab="",las=1)
lines(USY_Yds_TermPremium_Q$DATE,USY_Yds_TermPremium_Q$THREEFYTP2/100,
col="dark grey",lwd=3,lty=3)
plot(vec.dates,fitted.2yr.underQ-fitted.2yr.underP,type="l",lwd=3,lty=3,
ylim=c(-.005,.015),col="blue",
main="(c) 2-year term premium",xlab="",ylab="",las=1)
lines(USY_Yds_TermPremium_Q$DATE,USY_Yds_TermPremium_Q$THREEFYTP2/100,
col="dark grey",lwd=3,lty=2)
plot(vec.dates,fitted.2yr.underQ-fitted.2yr.underP,type="l",lwd=3,lty=3,
ylim=c(-.005,.015),col="blue",
main="(c) 2-year term premium",xlab="",ylab="",las=1)
lines(USY_Yds_TermPremium_Q$DATE,USY_Yds_TermPremium_Q$THREEFYTP2/100,
col="dark grey",lwd=3,lty=1)
plot(vec.dates,fitted.10yr.underQ-fitted.10yr.underP,type="l",lwd=3,lty=3,
ylim=c(-.005,.015),col="blue",
main="(d) 10-year term premium",xlab="",ylab="",las=1)
lines(USY_Yds_TermPremium_Q$DATE,USY_Yds_TermPremium_Q$THREEFYTP10/100,
col="dark grey",lwd=3,lty=1)
plot(vec.dates,fitted.10yr.underQ-fitted.10yr.underP,type="l",lwd=3,lty=3,
ylim=c(-.005,.025),col="blue",
main="(d) 10-year term premium",xlab="",ylab="",las=1)
lines(USY_Yds_TermPremium_Q$DATE,USY_Yds_TermPremium_Q$THREEFYTP10/100,
col="dark grey",lwd=3,lty=1)
plot(vec.dates,fitted.10yr.underQ-fitted.10yr.underP,type="l",lwd=3,lty=3,
ylim=c(-.005,.05),col="blue",
main="(d) 10-year term premium",xlab="",ylab="",las=1)
lines(USY_Yds_TermPremium_Q$DATE,USY_Yds_TermPremium_Q$THREEFYTP10/100,
col="dark grey",lwd=3,lty=1)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/prepare_outputs/chart.historical.fit.R", echo=TRUE)
data.frame.TP <- data.frame(DATE=vec.dates,
TP2=fitted.2yr.underQ-fitted.2yr.underP,
TP10=fitted.10yr.underQ-fitted.10yr.underP)
data.frame.TP <- merge(data.frame.TP,USY_Yds_TermPremium_Q,by=DATE)
data.frame.TP <- data.frame(DATE=vec.dates,
TP2=100*(fitted.2yr.underQ-fitted.2yr.underP),
TP10=100*(fitted.10yr.underQ-fitted.10yr.underP))
data.frame.TP <- merge(data.frame.TP,USY_Yds_TermPremium_Q,by="DATE")
View(data.frame.TP)
corr(data.frame.TP$TP2,data.frame.TP$THREEFYTP2)
cor(data.frame.TP$TP2,data.frame.TP$THREEFYTP2)
cor(data.frame.TP$TP10,data.frame.TP$THREEFYTP10)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/estimation/list_moments_2B_fitted.R", echo=TRUE)
all.multiplicative.factors
length(all.multiplicative.factors)
all.weights.US
all.target.names
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/procedures/set.of.procedures.Estimation.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/main.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/main.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/main.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/main.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/main.R", echo=TRUE)
nb.dec <- 2 # number of decimal numbers
format.nb  <- paste("%.",nb.dec,"f",sep="")
format.nb0 <- paste("%.",0,"f",sep="")
format.nb1 <- paste("%.",1,"f",sep="")
format.nb5 <- paste("%.",5,"f",sep="")
sprintf(format.nb,pi)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/prepare_outputs/make.table.yds.fit.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/prepare_outputs/make.table.yds.fit.R", echo=TRUE)
latex.table <- NULL
for(i in 1:length(names.of.rows)){
this.line <- names.of.rows[i]
this.line <- paste(this.line,"&",
sprintf(format.nb5,mean(observed[,i],na.rm=TRUE)),"&",
sprintf(format.nb5,mean(fitted[!is.na(observed[,i]),i],na.rm=TRUE)),"&",
"\\\\",
sep="")
latex.table <- rbind(latex.table,this.line)
}
latex.table
latex.table <- NULL
for(i in 1:length(names.of.rows)){
this.line <- names.of.rows[i]
this.line <- paste(this.line,"&",
sprintf(format.nb5,mean(observed[,i],na.rm=TRUE)),"&",
sprintf(format.nb5,mean(fitted[!is.na(observed[,i]),i],na.rm=TRUE)),"&",
sprintf(format.nb5,sd(observed[,i],na.rm=TRUE)),"&",
sprintf(format.nb5,sd(fitted[!is.na(observed[,i]),i],na.rm=TRUE)),"&",
"\\\\",
sep="")
latex.table <- rbind(latex.table,this.line)
}
latex.table
stdev.error
latex.table <- NULL
for(i in 1:length(names.of.rows)){
this.line <- names.of.rows[i]
this.line <- paste(this.line,"&",
sprintf(format.nb5,mean(observed[,i],na.rm=TRUE)),"&",
sprintf(format.nb5,mean(fitted[!is.na(observed[,i]),i],na.rm=TRUE)),"&",
sprintf(format.nb5,sd(observed[,i],na.rm=TRUE)),"&",
sprintf(format.nb5,sd(fitted[!is.na(observed[,i]),i],na.rm=TRUE)),"&",
sprintf(format.nb5,stdev.error[i]),
"\\\\",
sep="")
latex.table <- rbind(latex.table,this.line)
}
latex.table
all.target.names
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/main.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/prepare_outputs/make.table.yds.fit.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/prepare_outputs/make.tables.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/prepare_outputs/make.tables.R", echo=TRUE)
sprintf(paste("%.",2,"f",sep=""),
quantile.density(pdf,vec.of.quantiles[k]))
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/main.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/prepare_outputs/make.table.yds.fit.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/prepare_outputs/make.table.yds.fit.R", echo=TRUE)
latex.table
latex.table
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/prepare_outputs/make.table.yds.fit.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/prepare_outputs/make.table.yds.fit.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/prepare_outputs/make.table.yds.fit.R", echo=TRUE)
latex.table
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/prepare_outputs/make.table.yds.fit.R", echo=TRUE)
latex.table
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/main.R", echo=TRUE)
save(Full.Theta,file = "estimation/results/tempo.Rdat")
name.of.result.file <- "last.result" # name of result file (contains Full.Theta = parameterization of the model)
save(Full.Theta,file = paste("estimation/results/",name.of.result.file,".Rdat",sep=""))
if(indic.save.results.if.estim == 1){
# Overwrite previous result file:
save(Full.Theta,file = paste("estimation/results/",result.file,".Rdat",sep=""))
}
indic.save.results.if.estim
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/main.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/prepare_outputs/chart.historical.fit.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/prepare_outputs/chart.historical.fit.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/prepare_outputs/chart.historical.fit.R", echo=TRUE)
all.target.names
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/main.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/main.R", echo=TRUE)
Model.est$sigma.d
Model.est$sigma.pi
Model.est$g_c
all.multiplicative.factors
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/prepare_outputs/make.tables.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/prepare_outputs/make.tables.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/prepare_outputs/chart.distri.IR.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/prepare_outputs/chart.distri.IR.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/prepare_outputs/chart.distri.IR.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/prepare_outputs/chart.distri.IR.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/prepare_outputs/chart.distri.IR.R", echo=TRUE)
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/main.R", echo=TRUE)
file <- "Figure_IR_distri"
pdf(file=paste(output.figures.folder,"/",file,".pdf",sep=""),
pointsize=10, width=6, height=7)
par(mfrow=c(3,2))
par(plt=c(.1,.95,.23,.85))
for(j in 1:3){# Loop on regimes
for(maturity in vector.of.maturities.4){
adj <- res.prices$all.GDP.bond.yields[maturity,(index.min.S+1):NB.values.s] -
res.prices$all.GDP.bond.yields[maturity,(index.min.S):(NB.values.s-1)]
adj <- -1/adj
plot(res.prices$all.GDP.bond.yields[maturity,(index.min.S+1):NB.values.s],
pmax(res.mom.pi.z$E.z[(index.min.S+1):NB.values.s]*adj,0),
type="l",lwd=1,las=1,
xlab="Annualized yield to maturity",
ylab="",
yaxt="n",
col="white",
xlim=x.axis,
ylim = c(0,15),
main=paste(names.of.regimes[j],", maturity: ",toString(maturity/FREQ),ifelse(maturity<=4," year"," years"),sep="")
)
adj <- res.prices$all.rea.bond.yields[maturity,(index.min.S+1):NB.values.s] -
res.prices$all.rea.bond.yields[maturity,(index.min.S):(NB.values.s-1)]
adj <- -1/adj
Ez <- res.mom.pi.z$E.z[((j-1)*NB.values.s + index.min.S+1):
(j*NB.values.s)]
polygon(c(res.prices$all.rea.bond.yields[maturity,(index.min.S+1):NB.values.s],
res.prices$all.rea.bond.yields[maturity,NB.values.s:(index.min.S+1)]),
c(adj*Ez,0*Ez),
col=rgb(0,0,0,alpha=0.2),border=NA)
adj <- res.prices$all.GDP.bond.yields[maturity,(index.min.S+1):NB.values.s] -
res.prices$all.GDP.bond.yields[maturity,(index.min.S):(NB.values.s-1)]
adj <- -1/adj
lines(res.prices$all.GDP.bond.yields[maturity,(index.min.S+1):NB.values.s],
pmax(Ez*adj,0),
col="black",
lwd=1)
avg.GDP.yield <- res.prices$all.GDP.bond.yields[maturity,] %*% res.mom.pi.z$E.z
avg.rea.yield <- res.prices$all.rea.bond.yields[maturity,] %*% res.mom.pi.z$E.z
abline(v=avg.GDP.yield,col="black",lwd=2,lty=3)
abline(v=avg.rea.yield,col="dark grey",lwd=2,lty=3)
abline(h=0,lwd=1)
if((j==1)&(maturity==vector.of.maturities.4[1])){
legend("topright", # places a legend at the appropriate place c("Health","Defense"), # puts text in the legend
c("GDP-LB yields","ILB yields"),
lty=c(1,NaN), # gives the legend appropriate symbols (lines)
lwd=c(1,1), # line width
col=c("black",rgb(0,0,0,alpha=0.4)),
bg="white",
pch=c(NaN,22),
pt.bg=c(NaN,rgb(0,0,0,alpha=0.2)),
pt.cex = c(2),
seg.len = 2
)
}
}
}
source("~/Dropbox/Research/13_Macrofounded_SDF/3_Codes/GDP_LB/prepare_outputs/chart.distri.IR.R", echo=TRUE)
file <- "Figure_IR_distri"
pdf(file=paste(output.figures.folder,"/",file,".pdf",sep=""),
pointsize=10, width=6, height=7)
par(mfrow=c(3,2))
par(plt=c(.1,.95,.23,.85))
for(j in 1:3){# Loop on regimes
for(maturity in vector.of.maturities.4){
adj <- res.prices$all.GDP.bond.yields[maturity,(index.min.S+1):NB.values.s] -
res.prices$all.GDP.bond.yields[maturity,(index.min.S):(NB.values.s-1)]
adj <- -1/adj
plot(res.prices$all.GDP.bond.yields[maturity,(index.min.S+1):NB.values.s],
pmax(res.mom.pi.z$E.z[(index.min.S+1):NB.values.s]*adj,0),
type="l",lwd=1,las=1,
xlab="Annualized yield to maturity",
ylab="",
#yaxt="n",
col="white",
xlim=x.axis,
#ylim = c(0,15),
main=paste(names.of.regimes[j],", maturity: ",toString(maturity/FREQ),ifelse(maturity<=4," year"," years"),sep="")
)
adj <- res.prices$all.rea.bond.yields[maturity,(index.min.S+1):NB.values.s] -
res.prices$all.rea.bond.yields[maturity,(index.min.S):(NB.values.s-1)]
adj <- -1/adj
Ez <- res.mom.pi.z$E.z[((j-1)*NB.values.s + index.min.S+1):
(j*NB.values.s)]
polygon(c(res.prices$all.rea.bond.yields[maturity,(index.min.S+1):NB.values.s],
res.prices$all.rea.bond.yields[maturity,NB.values.s:(index.min.S+1)]),
c(adj*Ez,0*Ez),
col=rgb(0,0,0,alpha=0.2),border=NA)
adj <- res.prices$all.GDP.bond.yields[maturity,(index.min.S+1):NB.values.s] -
res.prices$all.GDP.bond.yields[maturity,(index.min.S):(NB.values.s-1)]
adj <- -1/adj
lines(res.prices$all.GDP.bond.yields[maturity,(index.min.S+1):NB.values.s],
pmax(Ez*adj,0),
col="black",
lwd=1)
avg.GDP.yield <- res.prices$all.GDP.bond.yields[maturity,] %*% res.mom.pi.z$E.z
avg.rea.yield <- res.prices$all.rea.bond.yields[maturity,] %*% res.mom.pi.z$E.z
abline(v=avg.GDP.yield,col="black",lwd=2,lty=3)
abline(v=avg.rea.yield,col="dark grey",lwd=2,lty=3)
abline(h=0,lwd=1)
if((j==1)&(maturity==vector.of.maturities.4[1])){
legend("topright", # places a legend at the appropriate place c("Health","Defense"), # puts text in the legend
c("GDP-LB yields","ILB yields"),
lty=c(1,NaN), # gives the legend appropriate symbols (lines)
lwd=c(1,1), # line width
col=c("black",rgb(0,0,0,alpha=0.4)),
bg="white",
pch=c(NaN,22),
pt.bg=c(NaN,rgb(0,0,0,alpha=0.2)),
pt.cex = c(2),
seg.len = 2
)
}
}
}
dev.off()
file <- "Figure_IR_distri"
pdf(file=paste(output.figures.folder,"/",file,".pdf",sep=""),
pointsize=10, width=6, height=7)
par(mfrow=c(3,2))
par(plt=c(.1,.95,.23,.85))
for(j in 1:3){# Loop on regimes
for(maturity in vector.of.maturities.4){
adj <- res.prices$all.GDP.bond.yields[maturity,(index.min.S+1):NB.values.s] -
res.prices$all.GDP.bond.yields[maturity,(index.min.S):(NB.values.s-1)]
adj <- -1/adj
plot(res.prices$all.GDP.bond.yields[maturity,(index.min.S+1):NB.values.s],
pmax(res.mom.pi.z$E.z[(index.min.S+1):NB.values.s]*adj,0),
type="l",lwd=1,las=1,
xlab="Annualized yield to maturity",
ylab="",
yaxt="n",
col="white",
xlim=x.axis,
ylim = c(0,15),
main=paste(names.of.regimes[j],", maturity: ",toString(maturity/FREQ),ifelse(maturity<=4," year"," years"),sep="")
)
adj <- res.prices$all.rea.bond.yields[maturity,(index.min.S+1):NB.values.s] -
res.prices$all.rea.bond.yields[maturity,(index.min.S):(NB.values.s-1)]
adj <- -1/adj
Ez <- res.mom.pi.z$E.z[((j-1)*NB.values.s + index.min.S+1):
(j*NB.values.s)]
polygon(c(res.prices$all.rea.bond.yields[maturity,(index.min.S+1):NB.values.s],
res.prices$all.rea.bond.yields[maturity,NB.values.s:(index.min.S+1)]),
c(adj*Ez,0*Ez),
col=rgb(0,0,0,alpha=0.2),border=NA)
adj <- res.prices$all.GDP.bond.yields[maturity,(index.min.S+1):NB.values.s] -
res.prices$all.GDP.bond.yields[maturity,(index.min.S):(NB.values.s-1)]
adj <- -1/adj
lines(res.prices$all.GDP.bond.yields[maturity,(index.min.S+1):NB.values.s],
pmax(Ez*adj,0),
col="black",
lwd=1)
avg.GDP.yield <- res.prices$all.GDP.bond.yields[maturity,] %*% res.mom.pi.z$E.z
avg.rea.yield <- res.prices$all.rea.bond.yields[maturity,] %*% res.mom.pi.z$E.z
abline(v=avg.GDP.yield,col="black",lwd=2,lty=3)
abline(v=avg.rea.yield,col="dark grey",lwd=2,lty=3)
abline(h=0,lwd=1)
if((j==1)&(maturity==vector.of.maturities.4[1])){
legend("topright", # places a legend at the appropriate place c("Health","Defense"), # puts text in the legend
c("GDP-LB yields","ILB yields"),
lty=c(1,NaN), # gives the legend appropriate symbols (lines)
lwd=c(1,1), # line width
col=c("black",rgb(0,0,0,alpha=0.4)),
bg="white",
pch=c(NaN,22),
pt.bg=c(NaN,rgb(0,0,0,alpha=0.2)),
pt.cex = c(2),
seg.len = 2
)
}
}
}
dev.off()
file <- "Figure_IR_distri"
pdf(file=paste(output.figures.folder,"/",file,".pdf",sep=""),
pointsize=10, width=6, height=7)
par(mfrow=c(3,2))
par(plt=c(.1,.95,.23,.85))
for(j in 1:3){# Loop on regimes
for(maturity in vector.of.maturities.4){
adj <- res.prices$all.GDP.bond.yields[maturity,(index.min.S+1):NB.values.s] -
res.prices$all.GDP.bond.yields[maturity,(index.min.S):(NB.values.s-1)]
adj <- -1/adj
plot(res.prices$all.GDP.bond.yields[maturity,(index.min.S+1):NB.values.s],
pmax(res.mom.pi.z$E.z[(index.min.S+1):NB.values.s]*adj,0),
type="l",lwd=1,las=1,
xlab="Annualized yield to maturity",
ylab="",
yaxt="n",
col="white",
xlim=x.axis,
ylim = c(0,10),
main=paste(names.of.regimes[j],", maturity: ",toString(maturity/FREQ),ifelse(maturity<=4," year"," years"),sep="")
)
adj <- res.prices$all.rea.bond.yields[maturity,(index.min.S+1):NB.values.s] -
res.prices$all.rea.bond.yields[maturity,(index.min.S):(NB.values.s-1)]
adj <- -1/adj
Ez <- res.mom.pi.z$E.z[((j-1)*NB.values.s + index.min.S+1):
(j*NB.values.s)]
polygon(c(res.prices$all.rea.bond.yields[maturity,(index.min.S+1):NB.values.s],
res.prices$all.rea.bond.yields[maturity,NB.values.s:(index.min.S+1)]),
c(adj*Ez,0*Ez),
col=rgb(0,0,0,alpha=0.2),border=NA)
adj <- res.prices$all.GDP.bond.yields[maturity,(index.min.S+1):NB.values.s] -
res.prices$all.GDP.bond.yields[maturity,(index.min.S):(NB.values.s-1)]
adj <- -1/adj
lines(res.prices$all.GDP.bond.yields[maturity,(index.min.S+1):NB.values.s],
pmax(Ez*adj,0),
col="black",
lwd=1)
avg.GDP.yield <- res.prices$all.GDP.bond.yields[maturity,] %*% res.mom.pi.z$E.z
avg.rea.yield <- res.prices$all.rea.bond.yields[maturity,] %*% res.mom.pi.z$E.z
abline(v=avg.GDP.yield,col="black",lwd=2,lty=3)
abline(v=avg.rea.yield,col="dark grey",lwd=2,lty=3)
abline(h=0,lwd=1)
if((j==1)&(maturity==vector.of.maturities.4[1])){
legend("topright", # places a legend at the appropriate place c("Health","Defense"), # puts text in the legend
c("GDP-LB yields","ILB yields"),
lty=c(1,NaN), # gives the legend appropriate symbols (lines)
lwd=c(1,1), # line width
col=c("black",rgb(0,0,0,alpha=0.4)),
bg="white",
pch=c(NaN,22),
pt.bg=c(NaN,rgb(0,0,0,alpha=0.2)),
pt.cex = c(2),
seg.len = 2
)
}
}
}
dev.off()
file <- "Figure_IR_distri"
pdf(file=paste(output.figures.folder,"/",file,".pdf",sep=""),
pointsize=10, width=6, height=7)
par(mfrow=c(3,2))
par(plt=c(.1,.95,.23,.85))
for(j in 1:3){# Loop on regimes
for(maturity in vector.of.maturities.4){
adj <- res.prices$all.GDP.bond.yields[maturity,(index.min.S+1):NB.values.s] -
res.prices$all.GDP.bond.yields[maturity,(index.min.S):(NB.values.s-1)]
adj <- -1/adj
plot(res.prices$all.GDP.bond.yields[maturity,(index.min.S+1):NB.values.s],
pmax(res.mom.pi.z$E.z[(index.min.S+1):NB.values.s]*adj,0),
type="l",lwd=1,las=1,
xlab="Annualized yield to maturity",
ylab="",
yaxt="n",
col="white",
xlim=x.axis,
ylim = c(0,12),
main=paste(names.of.regimes[j],", maturity: ",toString(maturity/FREQ),ifelse(maturity<=4," year"," years"),sep="")
)
adj <- res.prices$all.rea.bond.yields[maturity,(index.min.S+1):NB.values.s] -
res.prices$all.rea.bond.yields[maturity,(index.min.S):(NB.values.s-1)]
adj <- -1/adj
Ez <- res.mom.pi.z$E.z[((j-1)*NB.values.s + index.min.S+1):
(j*NB.values.s)]
polygon(c(res.prices$all.rea.bond.yields[maturity,(index.min.S+1):NB.values.s],
res.prices$all.rea.bond.yields[maturity,NB.values.s:(index.min.S+1)]),
c(adj*Ez,0*Ez),
col=rgb(0,0,0,alpha=0.2),border=NA)
adj <- res.prices$all.GDP.bond.yields[maturity,(index.min.S+1):NB.values.s] -
res.prices$all.GDP.bond.yields[maturity,(index.min.S):(NB.values.s-1)]
adj <- -1/adj
lines(res.prices$all.GDP.bond.yields[maturity,(index.min.S+1):NB.values.s],
pmax(Ez*adj,0),
col="black",
lwd=1)
avg.GDP.yield <- res.prices$all.GDP.bond.yields[maturity,] %*% res.mom.pi.z$E.z
avg.rea.yield <- res.prices$all.rea.bond.yields[maturity,] %*% res.mom.pi.z$E.z
abline(v=avg.GDP.yield,col="black",lwd=2,lty=3)
abline(v=avg.rea.yield,col="dark grey",lwd=2,lty=3)
abline(h=0,lwd=1)
if((j==1)&(maturity==vector.of.maturities.4[1])){
legend("topright", # places a legend at the appropriate place c("Health","Defense"), # puts text in the legend
c("GDP-LB yields","ILB yields"),
lty=c(1,NaN), # gives the legend appropriate symbols (lines)
lwd=c(1,1), # line width
col=c("black",rgb(0,0,0,alpha=0.4)),
bg="white",
pch=c(NaN,22),
pt.bg=c(NaN,rgb(0,0,0,alpha=0.2)),
pt.cex = c(2),
seg.len = 2
)
}
}
}
dev.off()
